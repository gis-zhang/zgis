<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
</head>
<body>
<script src="../src/lib/Indoor3D/js/three.min.js"></script>
<script src="../src/lib/leaflet-0.7.3/leaflet-src.js"></script>
<script src="../dist/zmap-release.js"></script>
<script src="../src/lib/Indoor3D/js/Detector.js"></script>
<script src="../src/lib/Indoor3D/js/OrbitControls.js"></script>
<script src="../src/lib/Indoor3D/js/IndoorMap.js"></script>
<script src="../src/lib/Indoor3D/js/stats.min.js"></script>
<script src="../src/lib/Indoor3D/js/Projector.js"></script>
<script src="../src/lib/Indoor3D/js/IndoorMap2d.js"></script>
<script src="../src/lib/Indoor3D/js/IndoorMap3d.js"></script>
<link href="../src/lib/Indoor3D/css/indoor3D.css" rel="stylesheet">

<script>


    var params = {
        //mapDiv:"indoor3d"
        //,dim:"2d"
    }
    var indoorMap = IndoorMap(params);

    var testjson;
    var loader = new IndoorMapLoader(indoorMap.is3d, {sceneSize: indoorMap.getSize()});
    loader.load('../src/lib/Indoor3D/data/bj10.json', function(mall){
        testjson = mall.jsonData;
        indoorMap.parse(testjson);
        indoorMap.showFloor(1);
        indoorMap.setDefaultView();
        indoorMap.setSelectable(false);
        indoorMap.showPubPoints(true);
        indoorMap.setSelectable(true);

        var ul = IndoorMap.getUI(indoorMap);
        document.body.appendChild(ul);
    });

    indoorMap.setSelectionListener(function(id, data, event){
        if(data){
            alert(data.name);
        }
    });

    var stats = new Stats();
    stats.domElement.style.position = 'absolute';
    stats.domElement.style.top = '0px';
    document.body.appendChild(stats.domElement);
    animate();

    function animate(){
        requestAnimationFrame(animate);
        stats.update();
    }

    var vAngle = 5, hAngle = 5;
    var step = 10;

    function addHAngle(){
//        hAngle += 10;
//        indoorMap.changeViewAngle(hAngle, vAngle);
        indoorMap.changeViewAngle(step, 0);
    }

    function subHAngle(){
//        hAngle -= 10;
        indoorMap.changeViewAngle(-step, 0);
    }

    function addVAngle(){
//        vAngle += 10;
        indoorMap.changeViewAngle(0, step);
    }

    function subVAngle(){
//        vAngle -= 10;
        indoorMap.changeViewAngle(0, -step);
    }
</script>
<ul class="testButton" style="position:absolute; top: 500px">
    <li onclick="indoorMap.zoomIn(0.8)">Zoom In</li>
    <li onclick="indoorMap.zoomOut(0.8)">Zoom Out</li>
    <li onclick="indoorMap.setTopView()">Top View</li>
    <li onclick="indoorMap.setDefaultView()">Default View</li>

</ul>
<ul style="position:absolute; top: 50px; right: 50px;">
    <li onclick="addHAngle()" style="border: 1px solid #bbbbbb;list-style-type:none;">水平旋转+</li>
    <li onclick="subHAngle()" style="border: 1px solid #bbbbbb;list-style-type:none;">水平旋转-</li>
    <li onclick="addVAngle()" style="border: 1px solid #bbbbbb;list-style-type:none;">垂直旋转+</li>
    <li onclick="subVAngle()" style="border: 1px solid #bbbbbb;list-style-type:none;">垂直旋转-</li>

</ul>
</body>
</html>